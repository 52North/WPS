(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c}})();(function(a){if(typeof define==="function"&&define.amd){define(a)}else{window.purl=a()}})(function(){var h={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],c={anchor:"fragment"},a={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},f=/^[0-9]+$/;function e(r,u){var w=decodeURI(r),t=a[u||false?"strict":"loose"].exec(w),v={attr:{},param:{},seg:{}},s=14;while(s--){v.attr[n[s]]=t[s]||""}v.param.query=i(v.attr.query);v.param.fragment=i(v.attr.fragment);v.seg.path=v.attr.path.replace(/^\/+|\/+$/g,"").split("/");v.seg.fragment=v.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");v.attr.base=v.attr.host?(v.attr.protocol?v.attr.protocol+"://"+v.attr.host:v.attr.host)+(v.attr.port?":"+v.attr.port:""):"";return v}function b(s){var r=s.tagName;if(typeof r!=="undefined"){return h[r.toLowerCase()]}return r}function q(v,u){if(v[u].length===0){return v[u]={}}var s={};for(var r in v[u]){s[r]=v[u][r]}v[u]=s;return s}function d(v,t,s,w){var r=v.shift();if(!r){if(g(t[s])){t[s].push(w)}else{if("object"==typeof t[s]){t[s]=w}else{if("undefined"==typeof t[s]){t[s]=w}else{t[s]=[t[s],w]}}}}else{var u=t[s]=t[s]||[];if("]"==r){if(g(u)){if(""!==w){u.push(w)}}else{if("object"==typeof u){u[p(u).length]=w}else{u=t[s]=[t[s],w]}}}else{if(~r.indexOf("]")){r=r.substr(0,r.length-1);if(!f.test(r)&&g(u)){u=q(t,s)}d(v,u,r,w)}else{if(!f.test(r)&&g(u)){u=q(t,s)}d(v,u,r,w)}}}}function k(v,u,x){if(~u.indexOf("]")){var w=u.split("[");d(w,v,"base",x)}else{if(!f.test(u)&&g(v.base)){var s={};for(var r in v.base){s[r]=v.base[r]}v.base=s}if(u!==""){l(v.base,u,x)}}return v}function i(r){return j(String(r).split(/&|;/),function(s,x){try{x=decodeURIComponent(x.replace(/\+/g," "))}catch(u){}var y=x.indexOf("="),w=o(x),t=x.substr(0,w||y),v=x.substr(w||y,x.length);v=v.substr(v.indexOf("=")+1,v.length);if(t===""){t=x;v=""}return k(s,t,v)},{base:{}}).base}function l(t,s,u){var r=t[s];if(typeof r==="undefined"){t[s]=u}else{if(g(r)){r.push(u)}else{t[s]=[r,u]}}}function o(u){var r=u.length,t,v;for(var s=0;s<r;++s){v=u[s];if("]"==v){t=false}if("["==v){t=true}if("="==v&&!t){return s}}}function j(v,s){var t=0,r=v.length>>0,u=arguments[2];while(t<r){if(t in v){u=s.call(undefined,u,v[t],t,v)}++t}return u}function g(r){return Object.prototype.toString.call(r)==="[object Array]"}function p(s){var r=[];for(var t in s){if(s.hasOwnProperty(t)){r.push(t)}}return r}function m(r,s){if(arguments.length===1&&r===true){s=true;r=undefined}s=s||false;r=r||window.location.toString();return{data:e(r,s),attr:function(t){t=c[t]||t;return typeof t!=="undefined"?this.data.attr[t]:this.data.attr},param:function(t){return typeof t!=="undefined"?this.data.param.query[t]:this.data.param.query},fparam:function(t){return typeof t!=="undefined"?this.data.param.fragment[t]:this.data.param.fragment},segment:function(t){if(typeof t==="undefined"){return this.data.seg.path}else{t=t<0?this.data.seg.path.length+t:t-1;return this.data.seg.path[t]}},fsegment:function(t){if(typeof t==="undefined"){return this.data.seg.fragment}else{t=t<0?this.data.seg.fragment.length+t:t-1;return this.data.seg.fragment[t]}}}}m.jQuery=function(r){if(r!=null){r.fn.url=function(t){var s="";if(this.length){s=r(this).attr(b(this[0]))||""}return m(s,t)};r.url=m}};m.jQuery(window.jQuery);return m});
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(i,f){var t=i.fn.domManip,h="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,p={},e={},y,x={key:0,data:{}},w=0,q=0,g=[];function k(B,A,D,E){var C={data:E||(E===0||E===false)?E:(A?A.data:{}),_wrap:A?A._wrap:null,tmpl:null,parent:A||null,nodes:[],calls:c,nest:b,wrap:n,html:r,update:z};if(B){i.extend(C,B,{nodes:[],parent:A})}if(D){C.tmpl=D;C._ctnt=C._ctnt||C.tmpl(i,C);C.key=++w;(g.length?e:p)[w]=C}return C}i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(A,B){i.fn[A]=function(C){var F=[],I=i(C),E,G,D,J,H=this.length===1&&this[0].parentNode;y=p||{};if(H&&H.nodeType===11&&H.childNodes.length===1&&I.length===1){I[B](this[0]);F=this}else{for(G=0,D=I.length;G<D;G++){q=G;E=(G>0?this.clone(true):this).get();i(I[G])[B](E);F=F.concat(E)}q=0;F=this.pushStack(F,A,I.selector)}J=y;y=null;i.tmpl.complete(J);return F}});i.fn.extend({tmpl:function(C,B,A){return i.tmpl(this[0],C,B,A)},tmplItem:function(){return i.tmplItem(this[0])},template:function(A){return i.template(A,this[0])},domManip:function(E,H,G,I){if(E[0]&&i.isArray(E[0])){var B=i.makeArray(arguments),A=E[0],F=A.length,C=0,D;while(C<F&&!(D=i.data(A[C++],"tmplItem"))){}if(D&&q){B[2]=function(J){i.tmpl.afterManip(this,J,G)}}t.apply(this,B)}else{t.apply(this,arguments)}q=0;if(!y){i.tmpl.complete(p)}return this}});i.extend({tmpl:function(C,F,E,B){var D,A=!B;if(A){B=x;C=i.template[C]||i.template(null,C);e={}}else{if(!C){C=B.tmpl;p[B.key]=B;B.nodes=[];if(B.wrapped){s(B,B.wrapped)}return i(m(B,null,B.tmpl(i,B)))}}if(!C){return[]}if(typeof F==="function"){F=F.call(B||{})}if(E&&E.wrapped){s(E,E.wrapped)}D=i.isArray(F)?i.map(F,function(G){return G?k(E,B,C,G):null}):[k(E,B,C,F)];return A?i(m(B,null,D)):D},tmplItem:function(B){var A;if(B instanceof i){B=B[0]}while(B&&B.nodeType===1&&!(A=i.data(B,"tmplItem"))&&(B=B.parentNode)){}return A||x},template:function(B,A){if(A){if(typeof A==="string"){A=l(A)}else{if(A instanceof i){A=A[0]||{}}}if(A.nodeType){A=i.data(A,"tmpl")||i.data(A,"tmpl",l(A.innerHTML))}return typeof B==="string"?(i.template[B]=A):A}return B?(typeof B!=="string"?i.template(null,B):(i.template[B]||i.template(null,u.test(B)?B:i(B)))):null},encode:function(A){return(""+A).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(A){p={}},afterManip:function v(C,A,D){var B=A.nodeType===11?i.makeArray(A.childNodes):A.nodeType===1?[A]:[];D.call(C,A);o(B);q++}});function m(A,E,C){var D,B=C?i.map(C,function(F){return(typeof F==="string")?(A.key?F.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+h+'="'+A.key+'" $2'):F):m(F,A,F._ctnt)}):A;if(E){return B}B=B.join("");B.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(G,H,F,I){D=i(F).get();o(D);if(H){D=a(H).concat(D)}if(I){D=D.concat(a(I))}});return D?D:a(B)}function a(B){var A=document.createElement("div");A.innerHTML=B;return i.makeArray(A.childNodes)}function l(A){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+i.trim(A).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(I,C,G,D,E,J,F){var L=i.tmpl.tag[G],B,H,K;if(!L){throw"Unknown template tag: "+G}B=L._default||[];if(J&&!/\w$/.test(E)){E+=J;J=""}if(E){E=j(E);F=F?(","+j(F)+")"):(J?")":"");H=J?(E.indexOf(".")>-1?E+j(J):("("+E+").call($item"+F)):E;K=J?H:"(typeof("+E+")==='function'?("+E+").call($item):("+E+"))"}else{K=H=B.$1||"null"}D=j(D);return"');"+L[C?"close":"open"].split("$notnull_1").join(E?"typeof("+E+")!=='undefined' && ("+E+")!=null":"true").split("$1a").join(K).split("$1").join(H).split("$2").join(D||B.$2||"")+"__.push('"})+"');}return __;")}function s(B,A){B._wrap=m(B,true,i.isArray(A)?A:[u.test(A)?A:i(A).html()]).join("")}function j(A){return A?A.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function d(A){var B=document.createElement("div");B.appendChild(A.cloneNode(true));return B.innerHTML}function o(G){var I="_"+q,B,A,E={},F,D,C;for(F=0,D=G.length;F<D;F++){if((B=G[F]).nodeType!==1){continue}A=B.getElementsByTagName("*");for(C=A.length-1;C>=0;C--){H(A[C])}H(B)}function H(O){var L,N=O,M,J,K;if((K=O.getAttribute(h))){while(N.parentNode&&(N=N.parentNode).nodeType===1&&!(L=N.getAttribute(h))){}if(L!==K){N=N.parentNode?(N.nodeType===11?0:(N.getAttribute(h)||0)):0;if(!(J=p[K])){J=e[K];J=k(J,p[N]||e[N]);J.key=++w;p[w]=J}if(q){P(K)}}O.removeAttribute(h)}else{if(q&&(J=i.data(O,"tmplItem"))){P(J.key);p[J.key]=J;N=i.data(O.parentNode,"tmplItem");N=N?N.key:0}}if(J){M=J;while(M&&M.key!=N){M.nodes.push(O);M=M.parent}delete J._ctnt;delete J._wrap;i.data(O,"tmplItem",J)}function P(Q){Q=Q+I;J=E[Q]=(E[Q]||k(J,p[J.parent.key+I]||J.parent))}}}function c(C,A,D,B){if(!C){return g.pop()}g.push({_:C,tmpl:A,item:this,data:D,options:B})}function b(A,C,B){return i.tmpl(i.template(A),C,B,this)}function n(C,A){var B=C.options||{};B.wrapped=A;return i.tmpl(i.template(C.tmpl),C.data,B,C.item)}function r(B,C){var A=this._wrap;return i.map(i(i.isArray(A)?A.join(""):A).filter(B||"*"),function(D){return C?D.innerText||D.textContent:D.outerHTML||d(D)})}function z(){var A=this.nodes;i.tmpl(null,null,null,this).insertBefore(A[0]);i(A).remove()}})(jQuery);var GET_CAPABILITIES_TYPE="GetCapabilities";var DESCRIBE_PROCESS_TYPE="DescribeProcess";var EXECUTE_TYPE="Execute";var OWS_11_NAMESPACE="http://www.opengis.net/ows/1.1";var WPS_100_NAMESPACE="http://www.opengis.net/wps/1.0.0";var METHOD_POST="POST";var METHOD_GET="GET";var PARAM_WPS_REQUEST_URL="wpsRequestUrl";var PARAM_WPS_REQUEST_TYPE="wpsRequestType";var USE_PROXY=false;var PROXY_URL="";var PROXY_TYPE="";var USER_TEMPLATE_CAPABILITIES_MARKUP=null;var USER_TEMPLATE_PROCESS_DESCRIPTION_MARKUP=null;var USER_TEMPLATE_EXECUTE_RESPONSE_MARKUP=null;function wpsResetSetup(){USE_PROXY=false;PROXY_URL="";PROXY_TYPE="";USER_TEMPLATE_CAPABILITIES_MARKUP=null;USER_TEMPLATE_PROCESS_DESCRIPTION_MARKUP=null;USER_TEMPLATE_EXECUTE_RESPONSE_MARKUP=null}function equalsString(d,c){if(!d){return false}if(!c){return false}return jQuery.trim(d).localeCompare(jQuery.trim(c))==0}function stringStartsWith(b,a){return b.indexOf(a)==0}function fillXMLTemplate(d,c){var a=d;for(var b in c){if(c.hasOwnProperty(b)){a=a.replace("${"+b+"}",c[b])}}return a}var WPSConfiguration=Class.extend({init:function(a){this.settings=a},getServiceUrl:function(){return this.settings.url}});var BaseResponse=Class.extend({init:function(a,b){this.xmlResponse=a;this.originalRequest=b},createMarkup:function(){return'<div class="wps-success"><div class="wps-generic-success"></div></div>'}});var TEMPLATE_CAPABILITIES_MARKUP='	<div class="wps-capabilities"> 		<div class="wps-capabilities-serviceidentification"> 			<ul class="wps-capabilities-list"> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Title</label><span class="wps-item-value">${serviceTitle}</span></li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Abstract</label><span class="wps-item-value">${serviceAbstract}</li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Keywords</label><span class="wps-item-value">${serviceKeywords}</li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Type</label><span class="wps-item-value">${serviceType}</li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Version</label><span class="wps-item-value">${serviceVersion}</li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Fees</label><span class="wps-item-value">${serviceFees}</li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Access constraints</label><span class="wps-item-value">${serviceAccessConstraints}</li> 			</ul> 		</div> 		<div class="wps-capabilities-serviceprovider"> 			<ul class="wps-capabilities-list"> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Provider name</label><span class="wps-item-value">${providerName}</li> 				<li class="wps-capabilities-list-entry"> 					<label class="wps-item-label">Provider site</label><span class="wps-item-value"><a href="${providerSite}" target="_blank" title="Open link in new window">${providerSite}</a></li> 			</ul> 			<div class="wps-capabilities-serviceprovider-contact"> 		</div> 		<div class="wps-capabilities-full-link"> 			<a href="${capabilitiesFullLink}" title="Show original capabilities document in a new window" target="_blank">Full capabilities</a> 		</div> 	</div>';var CapabilitiesResponse=BaseResponse.extend({createMarkup:function(){var f=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"ServiceIdentification");var e=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"Title")[0];var h=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"Abstract");var a=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"Keyword");var g="";jQuery.each(a,function(n,o){g+=jQuery(o).text()+" "});var c=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"ServiceType");var d=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"ServiceTypeVersion");var j=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"Fees");var k=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"AccessConstraints");var m=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"ProviderName");var l=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"ProviderSite");var b=jQuery(l).attr("xlink:href");capabilitiesProperties={serviceTitle:jQuery(e).text(),serviceAbstract:jQuery(h).text(),serviceKeywords:g,serviceType:jQuery(c).text(),serviceVersion:jQuery(d).text(),serviceFees:jQuery(j).text(),serviceAccessConstraints:jQuery(k).text(),providerName:jQuery(m).text(),providerSite:b,capabilitiesFullLink:this.originalRequest.settings.url};var i=jQuery.tmpl(TEMPLATE_CAPABILITIES_MARKUP,capabilitiesProperties);return i}});var TEMPLATE_PROCESS_DESCRIPTION_MARKUP='	<div class="wps-process-description"> 		<div class="wps-process-description-general"> 			<ul class="process-description-list"> 				<li class="wps-execute-response-list-entry>${process-identifier}<li> 				<li class="wps-execute-response-list-entry>${process-title}<li> 			</ul> 		</div> 		<div class="wps-process-description-inputs"> 			<ul class="process-description-list"> 				<li class="wps-execute-response-list-entry>${process-identifier}<li> 				<li class="wps-execute-response-list-entry>${process-title}<li> 			</ul> 		</div> 		<div class="wps-process-description-outputs"> 			<ul class="process-description-list"> 				<li class="wps-execute-response-list-entry>${process-identifier}<li> 				<li class="wps-execute-response-list-entry>${process-title}<li> 			</ul> 		</div> 	</div>';var DescribeProcessResponse=BaseResponse.extend({createMarkup:function(){var b=xml.getElementsByTagNameNS(OWS_11_NAMESPACE,"ProviderName");var a="<div>"+jQuery(b).text()+"</div>";return this._super(a)}});var TEMPLATE_EXECUTE_RESPONSE_MARKUP='	<div class="wps-execute-response"> 		<div class="wps-execute-autoUpdate" id="wps-execute-autoUpdate" style="${updateSwitchEnabled}"></div> 		<div class="wps-execute-response-process"> 			<ul class="wps-execute-response-list"> 				<li class="wps-execute-response-list-entry"> 					<label class="wps-item-label">Identifier</label><span class="wps-item-value">${identifier}</span></li> 				<li class="wps-execute-response-list-entry"> 					<label class="wps-item-label">Title</label><span class="wps-item-value">${title}</span></li> 			</ul> 		</div> 		<div class="wps-execute-response-status" id="wps-execute-response-status"> 			<ul class="wps-execute-response-list" id="wps-execute-response-list"> 				<li class="wps-execute-response-list-entry"> 					<label class="wps-item-label">Created on </label><span class="wps-item-value">${creationTime}</span></li> 			</ul> 		</div> 		<div id="wps-execute-response-extension"></div> 	</div>';var TEMPLATE_EXECUTE_RESPONSE_EXTENSION_MARKUP_DOWNLOAD='	<div class="wps-execute-response-result"> 			<label class="wps-extension-item-label">${key}</label><span class="wps-item-value"><a href="${value}" title="${title}">download</a></span></li> 	</div>';var TEMPLATE_EXECUTE_RESPONSE_EXTENSION_MARKUP_VALUE='	<div class="wps-execute-response-result"> 			<label class="wps-extension-item-label">${key}</label><span class="wps-item-value" title="${title} | ${valueType}">${value}</span></li> 	</div>';var TEMPLATE_EXECUTE_RESPONSE_STATUS_NORMAL_MARKUP='	<li class="wps-execute-response-list-entry"> 			<label class="wps-item-label">Status</label><span class="wps-item-value">${status}</span> 	</li>';var TEMPLATE_EXECUTE_RESPONSE_STATUS_FAILED_MARKUP='	<li class="wps-execute-response-list-entry"> 			<label class="wps-item-label">Status</label><span class="wps-item-error-value">${status}</span> 	</li> 	<li class="wps-execute-response-list-entry"> 			<label class="wps-item-label">Message</label><span class="wps-item-error-message-value">${message}</span> 	</li>';var ExecuteResponse=BaseResponse.extend({resolveProcessOutputs:function(h){var l=h.getElementsByTagNameNS(WPS_100_NAMESPACE,"Output");var f=new Array(l.length);for(var d=0;d<l.length;d++){var e=l[d];var g=e.getElementsByTagNameNS(OWS_11_NAMESPACE,"Identifier");var j=e.getElementsByTagNameNS(OWS_11_NAMESPACE,"Title");var a=e.getElementsByTagNameNS(WPS_100_NAMESPACE,"Reference");var c=e.getElementsByTagNameNS(WPS_100_NAMESPACE,"Data");var k;var b=null;if(a&&a.length>0){k=a[0].getAttribute("href");f[d]={key:jQuery(g).text(),title:jQuery(j).text(),value:k,ref:true}}else{if(c&&c.length>0){k="",b="";jQuery(c).children().each(function(n,o){var i=jQuery(o);k+=i.text();b+=i.attr("dataType")})}else{k="n/a"}f[d]={key:jQuery(g).text(),title:jQuery(j).text(),value:k,valueType:b,ref:false}}}var m={outputs:f};return m},createMarkup:function(){var m=this.xmlResponse.getElementsByTagNameNS(WPS_100_NAMESPACE,"Process");var n=this.xmlResponse.getElementsByTagNameNS(WPS_100_NAMESPACE,"Status");var k=null;var w={};var s=null;var h=null;var g=false;if(m&&m[0]&&n&&n[0]){var e=jQuery(m[0].getElementsByTagNameNS(OWS_11_NAMESPACE,"Identifier")).text();var A=jQuery(m[0].getElementsByTagNameNS(OWS_11_NAMESPACE,"Title")).text();var a=n[0].getElementsByTagNameNS(WPS_100_NAMESPACE,"ProcessAccepted");if(a&&a.length>0){s=jQuery(a).text()}if(!s){var b=n[0].getElementsByTagNameNS(WPS_100_NAMESPACE,"ProcessStarted");if(b&&b.length>0){var c=b[0].getAttribute("percentCompleted");s="Process started ("+c+" % complete)"}}if(!s){var t=n[0].getElementsByTagNameNS(WPS_100_NAMESPACE,"ProcessPaused");if(t&&t.length>0){s="Process paused"}}if(!s){var r=n[0].getElementsByTagNameNS(WPS_100_NAMESPACE,"ProcessSucceeded");if(r&&r.length>0){s="Process succeeded";var x=this.xmlResponse.getElementsByTagNameNS(WPS_100_NAMESPACE,"ProcessOutputs");if(x&&x.length>0){w=jQuery.extend(this.resolveProcessOutputs(x[0]),w)}}}if(!s){var z=n[0].getElementsByTagNameNS(WPS_100_NAMESPACE,"ProcessFailed");if(z&&z.length>0){s="Process failed";exceptionText=n[0].getElementsByTagNameNS(OWS_11_NAMESPACE,"ExceptionText");if(exceptionText){h=exceptionText.item(0).innerHTML}g=true}}var j=n[0].getAttribute("creationTime");if(j){var q=new Date(j);j=q.toLocaleString()}var i;if(this.originalRequest.updateSwitch){i=""}else{i="display:none"}k={identifier:e,title:A,creationTime:j,updateSwitchEnabled:i}}var v=this.xmlResponse.documentElement.getAttribute("statusLocation");if(v){this.originalRequest.settings.url=v;var o={url:this.originalRequest.settings.url,requestType:this.originalRequest.settings.requestType,type:"GET"};this.originalRequest=new GetRequest(o)}var y;if(USER_TEMPLATE_EXECUTE_RESPONSE_MARKUP!=null){y=USER_TEMPLATE_EXECUTE_RESPONSE_MARKUP}else{y=TEMPLATE_EXECUTE_RESPONSE_MARKUP}var l=jQuery.tmpl(y,k);var p=l.children("#wps-execute-response-status");var f=p.children("#wps-execute-response-list");statusProperties={status:s,message:h};if(!g){jQuery.tmpl(TEMPLATE_EXECUTE_RESPONSE_STATUS_NORMAL_MARKUP,statusProperties).appendTo(f)}else{jQuery.tmpl(TEMPLATE_EXECUTE_RESPONSE_STATUS_FAILED_MARKUP,statusProperties).appendTo(f)}if(w&&!jQuery.isEmptyObject(w)){var u=l.children("#wps-execute-response-extension");if(w.outputs){jQuery(w.outputs).each(function(d,B){if(B.ref==true){jQuery.tmpl(TEMPLATE_EXECUTE_RESPONSE_EXTENSION_MARKUP_DOWNLOAD,B).appendTo(u)}else{jQuery.tmpl(TEMPLATE_EXECUTE_RESPONSE_EXTENSION_MARKUP_VALUE,B).appendTo(u)}})}}return l}});var ResponseFactory=Class.extend({init:function(a){this.settings=a},resolveResponseHandler:function(b,c){var a=b.documentElement;if(a.localName=="Capabilities"){return new CapabilitiesResponse(b,c)}else{if(a.localName=="ProcessDescriptions"){return new DescribeProcessResponse(b,c)}else{if(a.localName=="ExecuteResponse"){return new ExecuteResponse(b,c)}else{if(a.localName=="ExceptionReport"){return new ExceptionReportResponse(b,c)}}}}return null}});var TEMPLATE_EXCEPTION_REPORT_RESPONSE_MARKUP='	<div class="wps-exception-report-response"> 		<div class="wps-exception-report-response-exceptions"> 			<ul class="wps-exception-list" id="wps-exception-list"> 			</ul> 		</div> 		<div id="wps-exception-report-response-extension"></div> 	</div>';var TEMPLATE_EXCEPTION_MARKUP='	<li class="wps-execute-response-list-entry"> 			<label class="wps-item-label">Code</label><span class="wps-item-error-value">${code}</span> 	</li> 	<li class="wps-execute-response-list-entry"> 			<label class="wps-item-label">Text</label><span class="wps-item-error-message-value">${text}</span> 	</li>';var ExceptionReportResponse=BaseResponse.extend({createMarkup:function(){var h=this.xmlResponse.getElementsByTagNameNS(OWS_11_NAMESPACE,"Exception");console.log("Got exception response!");exceptions=jQuery(h);console.log(exceptions);var g=[];for(var e=0;e<exceptions.length;e++){var b=jQuery(exceptions[e]);var c={code:b.attr("exceptionCode"),text:b.text().trim()};g.push(c)}var d={};var a=jQuery.tmpl(TEMPLATE_EXCEPTION_REPORT_RESPONSE_MARKUP,d);var f=a.children("#wps-exception-list");if(g&&!jQuery.isEmptyObject(g)){jQuery(g).each(function(i,j){alert(i+" - "+j.code+": "+j.text);jQuery.tmpl(TEMPLATE_EXCEPTION_MARKUP,j).appendTo(f)})}return a}});var BaseRequest=Class.extend({init:function(a){this.settings=a},getSettings:function(){return this.settings},execute:function(b,a){this.callback=b;this.updateSwitch=a;this.preRequestExecution();this.executeHTTPRequest(this.prepareHTTPRequest());this.postRequestExecution()},preRequestExecution:function(){this.changeElementContent('<div class="wps-waiting"></div>')},postRequestExecution:function(){},processResponse:function(a){return'<div class="wps-success"><div class="wps-generic-success"></div></div>'},changeElementContent:function(a){if(this.settings.domElement){this.settings.domElement.html(a)}},prepareHTTPRequest:function(){return null},executeHTTPRequest:function(c){var a=this;var b=jQuery.extend({success:function(e){if(a.callback){a.callback(e,a.settings.domElement,a,a.updateSwitch)}else{htmlContent=a.processResponse(e);a.changeElementContent(htmlContent)}},error:function(){a.changeElementContent('<div class="wps-error"><div class="wps-generic-error"></div><div>An error occured while connecting to '+a.settings.url+"</div></div>")}},c);var d;if(USE_PROXY){if(PROXY_TYPE=="parameter"){d=PROXY_URL+encodeURIComponent(this.settings.url)}else{d=this.settings.url}}else{d=this.settings.url}jQuery.ajax(d,b)}});var GetRequest=BaseRequest.extend({prepareHTTPRequest:function(){var b=this.settings.url;var a=this.settings.urlQuery;if(!a){a=this.createTargetUrlQuery()}if(a){this.settings.url=this.buildTargetUrl(b,a)}return{type:"GET"}},createTargetUrlQuery:function(){return null},buildTargetUrl:function(b,a){if(b.indexOf("?")==-1){b+="?"}if(b.indexOf("service=")==-1){b+="service=WPS"}if(b.indexOf("version=")==-1){b+="&version=1.0.0"}if(a){b+="&"+a}return b}});var PostRequest=BaseRequest.extend({prepareHTTPRequest:function(){var a=this.settings.data;if(!a){a=this.createPostPayload()}return{type:"POST",data:a,contentType:"text/xml"}},createPostPayload:function(){return null},fillTemplate:function(b,a){return fillXMLTemplate(b,a)}});var EXECUTE_REQUEST_XML_START='<wps:Execute service="WPS" version="1.0.0" 	xmlns:wps="http://www.opengis.net/wps/1.0.0" 	xmlns:ows="http://www.opengis.net/ows/1.1" 	xmlns:xlink="http://www.w3.org/1999/xlink" 	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 	xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 	  http://schemas.opengis.net/wps/1.0.0/wpsExecute_request.xsd"> 	  <ows:Identifier>${processIdentifier}</ows:Identifier>	  <wps:DataInputs>		${dataInputs}      </wps:DataInputs>	  ${responseForm}	</wps:Execute>';var EXECUTE_REQUEST_XML_COMPLEX_DATA_ALL_INPUT='<wps:Input>	      <ows:Identifier>${identifier}</ows:Identifier>	      <wps:Data>			<wps:ComplexData schema="${schema}" mimeType="${mimeType}" encoding="${encoding}">			${complexPayload}			</wps:ComplexData>	      </wps:Data>	</wps:Input>';var EXECUTE_REQUEST_XML_COMPLEX_DATA_MIME_TYPE_INPUT='<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Data>		<wps:ComplexData mimeType="${mimeType}">		${complexPayload}		</wps:ComplexData>    </wps:Data></wps:Input>';var EXECUTE_REQUEST_XML_COMPLEX_DATA_SCHEMA_INPUT='<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Data>		<wps:ComplexData schema="${schema}" mimeType="${mimeType}">		${complexPayload}		</wps:ComplexData>    </wps:Data></wps:Input>';var EXECUTE_REQUEST_XML_COMPLEX_DATA_ENCODING_INPUT='<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Data>		<wps:ComplexData mimeType="${mimeType}" encoding="${encoding}">		${complexPayload}		</wps:ComplexData>    </wps:Data></wps:Input>';var EXECUTE_REQUEST_XML_COMPLEX_DATA_BY_REFERENCE_INPUT='<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Reference schema="${schema}" 	xlink:href="${href}" method="${method}"/>  </wps:Input>';var EXECUTE_REQUEST_XML_LITERAL_DATA_INPUT='<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Data>      <wps:LiteralData dataType="${dataType}">${value}</wps:LiteralData>    </wps:Data>  </wps:Input>';var EXECUTE_REQUEST_XML_LITERAL_DATA_NO_TYPE_INPUT="<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Data>      <wps:LiteralData>${value}</wps:LiteralData>    </wps:Data>  </wps:Input>";var EXECUTE_REQUEST_XML_BOUNDING_BOX_INPUT='<wps:Input>    <ows:Identifier>${identifier}</ows:Identifier>    <wps:Data>       <wps:BoundingBoxData ows:crs="${crs}" ows:dimensions="${dimension}">          <ows:LowerCorner>${lowerCorner}</ows:LowerCorner>          <ows:UpperCorner>${upperCorner}</ows:UpperCorner>       </wps:BoundingBoxData>    </wps:Data> </wps:Input>';var EXECUTE_REQUEST_XML_RESPONSE_FORM_RAW='<wps:ResponseForm>	    <wps:RawDataOutput mimeType="${mimeType}">	      <ows:Identifier>${identifier}</ows:Identifier>	    </wps:RawDataOutput>	  </wps:ResponseForm>';var EXECUTE_REQUEST_XML_RESPONSE_FORM_DOCUMENT='<wps:ResponseForm>    <wps:ResponseDocument storeExecuteResponse="${storeExecuteResponse}" 	lineage="${lineage}" status="${status}">	${outputs}    </wps:ResponseDocument>  </wps:ResponseForm>';var EXECUTE_REQUEST_XML_COMPLEX_ALL_OUTPUT='<wps:Output 	asReference="${asReference}" schema="${schema}" mimeType="${mimeType}" encoding="${encoding}">        <ows:Identifier>${identifier}</ows:Identifier>      </wps:Output>';var EXECUTE_REQUEST_XML_COMPLEX_MIME_TYPE_OUTPUT='<wps:Output 	asReference="${asReference}" mimeType="${mimeType}">        <ows:Identifier>${identifier}</ows:Identifier>      </wps:Output>';var EXECUTE_REQUEST_XML_COMPLEX_SCHEMA_OUTPUT='<wps:Output 	asReference="${asReference}" schema="${schema}" mimeType="${mimeType}">        <ows:Identifier>${identifier}</ows:Identifier>      </wps:Output>';var EXECUTE_REQUEST_XML_COMPLEX_ENCODING_OUTPUT='<wps:Output 	asReference="${asReference}" mimeType="${mimeType}" encoding="${encoding}">        <ows:Identifier>${identifier}</ows:Identifier>      </wps:Output>';var EXECUTE_REQUEST_XML_LITERAL_OUTPUT="<wps:Output>    <ows:Identifier>${identifier}</ows:Identifier>  </wps:Output>";var ExecuteRequest=PostRequest.extend({createPostPayload:function(){var b=this.settings.inputs;var f=this.settings.outputs;var c="";if(b){c=this.createDataInputsMarkup(b)}var e="";if(f){e=this.createResponseFormMarkup(f,this.settings.outputStyle)}var d={processIdentifier:this.settings.processIdentifier,dataInputs:c,responseForm:e};var a=this.fillTemplate(EXECUTE_REQUEST_XML_START,d);return a},createDataInputsMarkup:function(b){var a="";for(var d=0;d<b.length;d++){var c="";if(equalsString("literal",b[d].type)){c=this.createLiteralDataInput(b[d])}else{if(equalsString("complex",b[d].type)){c=this.createComplexDataInput(b[d])}else{if(equalsString("bbox",b[d].type)){c=this.createBoundingBoxDataInput(b[d])}}}a+=c}return a},createLiteralDataInput:function(b){var a;if(b.dataType){a=this.fillTemplate(EXECUTE_REQUEST_XML_LITERAL_DATA_INPUT,b)}else{a=this.fillTemplate(EXECUTE_REQUEST_XML_LITERAL_DATA_NO_TYPE_INPUT,b)}return a},createComplexDataInput:function(b){var a;if(b.href){a=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_DATA_BY_REFERENCE_INPUT,b)}else{if(b.schema&&b.encoding){a=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_DATA_ALL_INPUT,b)}else{if(b.schema&&!b.encoding){a=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_DATA_SCHEMA_INPUT,b)}else{if(!b.schema&&b.encoding){a=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_DATA_ENCODING_INPUT,b)}else{a=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_DATA_MIME_TYPE_INPUT,b)}}}}return a},createBoundingBoxDataInput:function(b){if(!b.crs){b.crs="EPSG:4326"}if(!b.dimension){b.dimension=2}var a=this.fillTemplate(EXECUTE_REQUEST_XML_BOUNDING_BOX_INPUT,b);return a},createResponseFormMarkup:function(d,e){var c="";for(var b=0;b<d.length;b++){if(equalsString("literal",d[b].type)){c+=this.fillTemplate(EXECUTE_REQUEST_XML_LITERAL_OUTPUT,d[b])}else{if(d[b].encoding&&d[b].schema){c+=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_ALL_OUTPUT,d[b])}else{if(d[b].encoding&&!d[b].schema){c+=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_ENCODING_OUTPUT,d[b])}else{if(!d[b].encoding&&d[b].schema){c+=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_SCHEMA_OUTPUT,d[b])}else{c+=this.fillTemplate(EXECUTE_REQUEST_XML_COMPLEX_MIME_TYPE_OUTPUT,d[b])}}}}}e.outputs=c;var a=this.fillTemplate(EXECUTE_REQUEST_XML_RESPONSE_FORM_DOCUMENT,e);return a}});var DescribeProcessGetRequest=GetRequest.extend({createTargetUrlQuery:function(){var a="request=DescribeProcess&identifier="+this.settings.processIdentifier;return a}});var GetCapabilitiesGetRequest=GetRequest.extend({createTargetUrlQuery:function(){return"request=GetCapabilities"}});var DESCRIBE_PROCESS_POST='<DescribeProcess 	xmlns="http://www.opengis.net/wps/1.0.0" 	xmlns:ows="http://www.opengis.net/ows/1.1" 	xmlns:xlink="http://www.w3.org/1999/xlink" 	service="WPS" version="1.0.0">	${identifierList}</DescribeProcess>';var DESCRIBE_PROCESS_POST_IDENTIFIER="<ows:Identifier>${identifier}</ows:Identifier>";var DescribeProcessPostRequest=PostRequest.extend({createPostPayload:function(){var a=this.settings.processIdentifier;var c="";if(a){if(jQuery.isArray(a)){for(var b=0;b<a.length;b++){c+=this.fillTemplate(DESCRIBE_PROCESS_POST_IDENTIFIER,{identifier:a[b]})}}else{c=this.fillTemplate(DESCRIBE_PROCESS_POST_IDENTIFIER,{identifier:a})}}return this.fillTemplate(DESCRIBE_PROCESS_POST,{identifierList:c})}});var GET_CAPABILITIES_POST='<wps:GetCapabilities 	xmlns:ows="http://www.opengis.net/ows/1.1" 	xmlns:wps="http://www.opengis.net/wps/1.0.0" 	xmlns:xlink="http://www.w3.org/1999/xlink" 	service="WPS">    <wps:AcceptVersions>		<ows:Version>1.0.0</ows:Version>	</wps:AcceptVersions>	</wps:GetCapabilities>';var GetCapabilitiesPostRequest=PostRequest.extend({createPostPayload:function(){return GET_CAPABILITIES_POST}});var TEMPLATE_EXECUTE_COMPLEX_INPUTS_MARKUP='	<div class="wps-execute-complex-inputs" id="input_${identifier}"> 		<div class="wps-execute-response-process"> 			<ul class="wps-execute-response-list"> 				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}${required}</label>{{html inputField}}{{html asReference}}</li> 				<li class="wps-execute-response-list-entry"> 					{{html formats}}{{html copyButton}}</li> 			</ul> 		</div> 	</div>';var TEMPLATE_EXECUTE_COMPLEX_INPUTS_COPY_MARKUP='				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}${required}</label>{{html inputField}}{{html asReference}}</li> 				<li class="wps-execute-response-list-entry"> 					{{html formats}}</li>';var TEMPLATE_EXECUTE_LITERAL_INPUTS_MARKUP='	<div class="wps-execute-literal-inputs" id="input_${identifier}"> 		<div class="wps-execute-response-process"> 			<ul class="wps-execute-response-list"> 				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}${required}</label>{{html inputField}}{{html copyButton}}</li> 			</ul> 		</div> 	</div>';var TEMPLATE_EXECUTE_LITERAL_INPUTS_COPY_MARKUP='				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}${required}</label>{{html inputField}}</li>';var TEMPLATE_EXECUTE_BBOX_INPUTS_MARKUP='	<div class="wps-execute-bbox-inputs" id="input_${identifier}"> 		<div class="wps-execute-response-process"> 			<ul class="wps-execute-response-list"> 				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}${required}</label>{{html inputField}}<label>${description}</label>{{html copyButton}}</li> 			</ul> 		</div> 	</div>';var TEMPLATE_EXECUTE_BBOX_INPUTS_COPY_MARKUP='				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}${required}</label>{{html inputField}}<label>${description}</label></li>';var TEMPLATE_EXECUTE_OUTPUTS_MARKUP='	<div class="wps-execute-complex-inputs"> 		<div class="wps-execute-response-process"> 			<ul class="wps-execute-response-list" id="outputs"> 			</ul> 		</div> 	</div>';var TEMPLATE_EXECUTE_COMPLEX_OUTPUTS_MARKUP='				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}</label>{{html settings}}</li> 				<li class="wps-execute-response-list-entry"> 					{{html formats}}</li>';var TEMPLATE_EXECUTE_LITERAL_OUTPUTS_MARKUP='				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}</label>{{html settings}}</li>';var TEMPLATE_EXECUTE_BBOX_OUTPUTS_MARKUP='				<li class="wps-execute-response-list-entry"> 					<label class="wps-input-item-label">${identifier}</label>{{html settings}}</li>';var FormBuilder=Class.extend({init:function(a){this.settings=a},clearForm:function(a){a.html("")},buildExecuteForm:function(e,d,c){var a=jQuery('<form id="wps-execute-form"></form>');a.submit(function(){c("wps-execute-form");return false});if(d["abstract"]!=null&&d["abstract"]!="null"){a.append(jQuery('<span id="abstract">'+d["abstract"]+"</span>"))}a.append(this.createFormInputs(d.dataInputs));a.append(this.createFormOutputs(d));a.append(jQuery('<input type="hidden" name="processIdentifier" value="'+d.identifier+'" />'));var b=jQuery('<button id="btn_execute">Execute</button>');a.append(b);e.append(jQuery("<div>").append(a))},createFormInputs:function(b){var a=jQuery('<div id="input"></div>');var g=jQuery('<div id="complex-inputs"/>');var d=jQuery('<div id="literal-inputs"/>');var e=jQuery('<div id="bbox-inputs"/>');a.append(g);a.append(d);a.append(e);var c;for(var f=0;f<b.length;f++){c=b[f];if(c.complexData){this.createInput(c,a,TEMPLATE_EXECUTE_COMPLEX_INPUTS_MARKUP,TEMPLATE_EXECUTE_COMPLEX_INPUTS_COPY_MARKUP,"complex-inputs",this.createComplexInput)}else{if(c.boundingBoxData){this.createInput(c,a,TEMPLATE_EXECUTE_BBOX_INPUTS_MARKUP,TEMPLATE_EXECUTE_BBOX_INPUTS_COPY_MARKUP,"bbox-inputs",this.createBoundingBoxInput)}else{if(c.literalData){this.createInput(c,a,TEMPLATE_EXECUTE_LITERAL_INPUTS_MARKUP,TEMPLATE_EXECUTE_LITERAL_INPUTS_COPY_MARKUP,"literal-inputs",this.createLiteralInput)}}}}return a},createInput:function(g,b,h,f,i,e){var k=e(g,this);if(g.minOccurs>0){k.required="*"}var a=g.identifier;var d=null;if(g.maxOccurs>1){var c=jQuery("<div></div>");d=this.addInputCopyButton(a);c.append(d);k.copyButton=c.html()}var j=jQuery.tmpl(h,k);j.appendTo(b);if(g.maxOccurs>1){if(d){d.onclick=function(){var m=this.createCopy(g,e);if(m){var l=jQuery("#"+i);jQuery.tmpl(f,m).appendTo(l)}}}}if(g.hidden){j.css("display","none")}},createComplexInput:function(k,n){var g={};var a=k.identifier;var e=jQuery("<div/>");var j=jQuery('<textarea class="wps-complex-input-textarea" title="'+k["abstract"]+'"/>');var f="";if(k.maxOccurs>1){f=(k.occurrence||1)}var b;var l;if(k.maxOccurs>1){l="input_"+a+f}else{l="input_"+a}j.attr("name",l);b=n.createInputTypeElement("complex",l);j.attr("title",k["abstract"]);if(k.predefinedValue){j.html(k.predefinedValue)}e.append(j);e.append(b);var d="";if(k.maxOccurs>1){d=k.identifier+"("+f+"/"+k.maxOccurs+")"}else{d=k.identifier}var i=k.complexData.supported.formats;var o=n.createFormatDropdown("format_"+l,i,k);var m=jQuery("<div />");m.append(o);var c=jQuery("<div />");var h=jQuery('<input type="checkbox" name="checkbox_'+l+'" value="asReference" title="This input is a reference to the actual input."/>');c.append(h);c.append("asReference");g.identifier=d;g.inputField=e.html();g.asReference=c.html();g.formats=m.html();return g},createLiteralInput:function(j,n){var g={};var c=jQuery("<div />");var d="";var e="";if(j.maxOccurs>1){e=(j.occurrence||1)}var a=j.identifier;var m="input_"+a+e;var l=j.literalData.anyValue;var i=l?jQuery("<input />"):jQuery("<select />");i.attr("name",m);var b=n.createInputTypeElement("literal",m);i.attr("title",j["abstract"]);c.append(i);c.append(b);if(j.maxOccurs>1){d=j.identifier+"("+e+"/"+j.maxOccurs+")"}else{d=j.identifier}if(l){var h=j.literalData.dataType}else{var f=jQuery("<option />");i.append(f);for(var k in j.literalData.allowedValues){f=jQuery("<option />");f.attr("value",k);f.html(k);if(j.predefinedValue&&equalsString(j.predefinedValue,k)){f.attr("selected",true)}i.append(f)}if(j.literalData.defaultValue){i.attr("value",j.literalData.defaultValue)}}if(j.predefinedValue){if(l){i.attr("value",j.predefinedValue)}}g.identifier=d;g.inputField=c.html();return g},createBoundingBoxInput:function(h,j){var c={};var d=jQuery("<div />");var e="";var f="";if(h.maxOccurs>1){f=(h.occurrence||1)}var a=h.identifier;var i="input_"+a+f;var g=jQuery("<input />");g.attr("title",h["abstract"]);g.attr("name",i);var b=j.createInputTypeElement("bbox",i);g.attr("title",h["abstract"]);if(h.predefinedValue){g.attr("value",h.predefinedValue)}d.append(g);d.append(b);if(h.maxOccurs>1){e=h.identifier+"("+f+"/"+h.maxOccurs+")"}else{e=h.identifier}c.identifier=e;c.inputField=d.html();c.description="left, bottom, right, top";return c},createInputTypeElement:function(c,b){var a=jQuery('<input type="hidden" value="'+c+'" name="type_'+b+'" />');return a},createFormatDrowpdownEntry:function(d){var a="";var c=d.schema;var b=d.encoding;var e=d.mimeType;if(c&&b){a=e+"; "+c+"; "+b}else{if(!c&&b){a=e+"; "+b}else{if(c&&!b){a=e+"; "+c}else{a=e}}}return a},createFormOutputs:function(d){var a=jQuery('<div id="output"></div>');jQuery.tmpl(TEMPLATE_EXECUTE_OUTPUTS_MARKUP,"").appendTo(a);var h=jQuery('<ul id="outputs" class="wps-execute-response-list"/>');a.append(h);var l=d.processOutputs;for(var e=0;e<l.length;e++){var c=l[e];var b="output_"+c.identifier;var q={};var k=null;var p=jQuery("<div />");var f=jQuery('<input type="checkbox"/>');f.attr("name",b);f.attr("title","Enable this output.");var j=this.createInputTypeElement(c.complexOutput?"complex":"literal",b);if(c.selected){f.attr("checked","checked")}p.append(f);p.append(j);q.identifier=b;q.settings=p.html();if(c.complexOutput){var g=c.complexOutput.supported.formats;var o=c.complexOutput["default"].formats[0];var n=this.createFormatDropdown("format_"+b,g,c);n.val(JSON.stringify(o));var m=jQuery("<div />");m.append(n);q.formats=m.html();k=TEMPLATE_EXECUTE_COMPLEX_OUTPUTS_MARKUP}else{if(c.literalOutput){k=TEMPLATE_EXECUTE_LITERAL_OUTPUTS_MARKUP}else{if(c.boundingBoxOutput){k=TEMPLATE_EXECUTE_BBOX_OUTPUTS_MARKUP}}}if(k){jQuery.tmpl(k,q).appendTo(h)}}return a},createFormatDropdown:function(h,b,c){var g=jQuery('<select name="'+h+'" title="'+c["abstract"]+'"/>');var e;for(var d=0;d<b.length;d++){var f=b[d];var a=this.createFormatDrowpdownEntry(f);e=jQuery("<option>"+a+"</option>");e.val(JSON.stringify(f));g.append(e)}return g},addInputCopyButton:function(b){var a=jQuery('<button class="add-input-copy" id="'+b+'-copy-button" />');return a},createCopy:function(b,a){if(b.maxOccurs&&b.maxOccurs>1){if(b.occurrence&&b.occurrence>=b.maxOccurs){return}var c=jQuery.extend({},b);b.occurrence=(b.occurrence||1)+1;c.occurrence=b.occurrence;return a(c)}}});var FormParser=Class.extend({init:function(a){this.settings=a},parseInputs:function(g){var b=[];var c={};for(var e=0;e<g.length;e++){var h=g[e];if(stringStartsWith(h.name,"input_")){if(h.value){var d=b.length;b[d]={};b[d].identifier=h.name.substring(6,h.name.length);b[d].value=h.value;c[h.name]=d}}}for(var e=0;e<g.length;e++){var h=g[e];if(stringStartsWith(h.name,"type_input")){var f=h.name.substring(5,h.name.length);if(c[f]!=null){b[c[f]].type=h.value;if(stringStartsWith(h.value,"complex")){b[c[f]].complexPayload=b[c[f]].value}else{if(stringStartsWith(h.value,"bbox")){this.parseBboxValue(b[c[f]].value,b[c[f]])}}}}}for(var e=0;e<g.length;e++){var h=g[e];if(stringStartsWith(h.name,"checkbox_input")){var f=h.name.substring(9,h.name.length);b[c[f]].asReference=true}}for(var e=0;e<g.length;e++){var h=g[e];if(stringStartsWith(h.name,"format_input")){var f=h.name.substring(7,h.name.length);var a=JSON.parse(h.value);this.parseFormatObject(a,b[c[f]])}}return b},parseBboxValue:function(c,a){var d=c.split(",");if(d.length<4){for(var b=d.length;b<4;b++){d[b]="0.0"}}a.lowerCorner=jQuery.trim(d[0])+" "+jQuery.trim(d[1]);a.upperCorner=jQuery.trim(d[2])+" "+jQuery.trim(d[3])},parseOutputs:function(f){var g=[];var e={};for(var d=0;d<f.length;d++){var h=f[d];if(stringStartsWith(h.name,"output_")){var c=g.length;g[c]={};g[c].identifier=h.name.substring(7,h.name.length);g[c].asReference=false;e[h.name]=c}}for(var d=0;d<f.length;d++){var h=f[d];if(stringStartsWith(h.name,"type_output")){var b=h.name.substring(5,h.name.length);if(e[b]!=null){g[e[b]].type=h.value;if(stringStartsWith(h.value,"complex")){g[e[b]].asReference=true}}}}for(var d=0;d<f.length;d++){var h=f[d];if(stringStartsWith(h.name,"format_output")){var b=h.name.substring(7,h.name.length);var a=JSON.parse(h.value);if(e[b]!=null){this.parseFormatObject(a,g[e[b]])}}}return g},parseFormatObject:function(a,b){if(a.mimeType){b.mimeType=a.mimeType}if(a.schema){b.schema=a.schema}if(a.encoding){b.encoding=a.encoding}},parseProcessIdentifier:function(b){for(var a=0;a<b.length;a++){var c=b[a];if(equalsString(c.name,"processIdentifier")){return c.value}}return""},parseOutputStyle:function(a){return{storeExecuteResponse:true,lineage:false,status:true}}});var wps;function resolveRequest(b,c,a){if(b==GET_CAPABILITIES_TYPE){return new GetCapabilitiesGetRequest(a)}else{if(b==DESCRIBE_PROCESS_TYPE){return new GetRequest(a)}else{if(b==EXECUTE_TYPE&&c==METHOD_POST){return new PostRequest(a)}}}return new GetRequest(a)}function resolveGetParameters(){var c=jQuery.url();var b=c.param(PARAM_WPS_REQUEST_URL);var a=c.param(PARAM_WPS_REQUEST_TYPE);if(b&&a){return{url:decodeURIComponent((b+"").replace(/\+/g,"%20")),requestType:a}}return null}function assertValidState(a){var b=true;if(a.method==METHOD_POST){b=jQuery.isXMLDoc(a.data)}return a.url&&a.requestType&&a.method&&b}function callbackOnResponseParsed(d,e,c){var b=new ResponseFactory();var a=b.resolveResponseHandler(d,c);if(a){e.html(a.createMarkup())}if(c.updateSwitch){if(!c.updateSwitch.callback){c.updateSwitch.callback=callbackOnResponseParsed}if(!c.updateSwitch.element){c.updateSwitch.element="wps-execute-autoUpdate"}jQuery("#"+c.updateSwitch.element).click(function(){var g=c.updateSwitch;var f={url:c.settings.url,requestType:c.settings.requestType,type:"GET",domElement:c.settings.domElement};c=new GetRequest(f);c.execute(g.callback,g)});jQuery("#"+c.updateSwitch.element).css("cursor","pointer")}}function removePocessesFromSelectFast(a){var e=document.getElementById(a);var d=e.parentNode;var c=e.cloneNode(false);d.replaceChild(c,e);var b=document.createElement("option");b.innerHTML="Select a process";b.value="Select a process";c.appendChild(b);c.onchange=e.onchange;return c}function getCapabilities(a){var c="processes";jQuery.wpsSetup({configuration:{url:a}});removePocessesFromSelectFast(c);var b=new GetCapabilitiesGetRequest({url:wps.getServiceUrl()});b.execute(function(f,g,e,d){capabilities=new OpenLayers.Format.WPSCapabilities().read(f);var k=document.getElementById(c);var i=capabilities.processOfferings,h;for(var j in i){h=document.createElement("option");h.innerHTML=i[j].identifier;h.value=j;k.appendChild(h)}jQuery("#"+c).each(function(){var l=jQuery(this).val();jQuery(this).html(jQuery("option",jQuery(this)).sort(function(n,m){return n.text.toUpperCase()==m.text.toUpperCase()?0:n.text.toUpperCase()<m.text.toUpperCase()?-1:1}));jQuery(this).val(l)})})}function describeProcess(b,a,c){if(!b){b=this.options[this.selectedIndex].value}if(!a){a=wps.getServiceUrl()}if(!c){c="wps-execute-container"}var d=new DescribeProcessGetRequest({url:a,processIdentifier:b});d.execute(function(h,m,n,g){var k=new OpenLayers.Format.WPSDescribeProcess().read(h);var e=k.processDescriptions[b];var i=new FormBuilder();i.clearForm(jQuery("#"+c));i.buildExecuteForm(jQuery("#"+c),e,execute);var f=jQuery('<a title="Full process description" target="_blank">Show Description</a>');f.attr("href",d.settings.url);jQuery("#"+c).prepend(jQuery('<div class="wps-description-link">').append(f));var l=jQuery(h.getElementsByTagNameNS(OWS_11_NAMESPACE,"Metadata"));if(l.length>0){var j=jQuery('<div class="wps-description-metadata">');j.append("<span>Metadata</span>");l.each(function(p,q){var o=jQuery(q);j.append(jQuery('<span class="wps-metadata-link"><a id="wps-description-metadata-'+p+'" href="'+o.attr("xlin:href")+'">'+o.attr("xlin:title")+"</a></span>"))});jQuery("#"+c).prepend(j)}})}function execute(g,h){var d=jQuery("#"+g).serializeArray();var a=new FormParser();var e=a.parseInputs(d);var i=a.parseOutputs(d);var b=a.parseProcessIdentifier(d);var j=a.parseOutputStyle(d);if(!h){h=wps.getServiceUrl()}var c={url:h,inputs:e,outputs:i,outputStyle:j,processIdentifier:b,domElement:jQuery("#executeProcess")};var f=new ExecuteRequest(c);f.execute(callbackOnResponseParsed,{})}(function(a){a.fn.extend({wpsCall:function(b){var c;if(b&&b.viaUrl){c=a.extend(resolveGetParameters(),{method:METHOD_GET})}else{c=a.extend({method:METHOD_GET},b)}if(assertValidState(c)){return this.each(function(){var e=a.extend({domElement:a(this)},c);var d=resolveRequest(e.requestType,e.method,e);d.execute(callbackOnResponseParsed,b.updateSwitch)})}return this.each()}});a.extend({wpsSetup:function(b){if(b.reset){wpsResetSetup();return}if(b.templates){var c=b.templates;if(c.capabilities){if(typeof c.capabilities=="string"){USER_TEMPLATE_CAPABILITIES_MARKUP=c.capabilities}}if(c.processDescription){if(typeof c.processDescription=="string"){USER_TEMPLATE_PROCESS_DESCRIPTION_MARKUP=c.processDescription}}if(c.executeResponse){if(typeof c.executeResponse=="string"){USER_TEMPLATE_EXECUTE_RESPONSE_MARKUP=c.executeResponse}}}if(b.proxy){USE_PROXY=true;PROXY_URL=b.proxy.url;if(OpenLayers){OpenLayers.ProxyHost=b.proxy.url}PROXY_TYPE=b.proxy.type}if(b.configuration){wps=new WPSConfiguration(b.configuration)}}})}(jQuery));